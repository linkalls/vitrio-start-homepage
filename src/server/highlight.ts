// AUTO-GENERATED by scripts/gen-highlight.mjs
// Do not edit manually.

export const HIGHLIGHT = {
  "routes_ts": "<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#B392F0\">defineRoute</span><span style=\"color:#E1E4E8\">({</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  path: </span><span style=\"color:#9ECBFF\">'/reference'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  loader</span><span style=\"color:#E1E4E8\">: (</span><span style=\"color:#FFAB70\">ctx</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> ({ </span><span style=\"color:#6A737D\">/* ... */</span><span style=\"color:#E1E4E8\"> }),</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  action</span><span style=\"color:#E1E4E8\">: (</span><span style=\"color:#FFAB70\">ctx</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">formData</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> ({ </span><span style=\"color:#6A737D\">/* ... */</span><span style=\"color:#E1E4E8\"> }),</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  component</span><span style=\"color:#E1E4E8\">: ({ </span><span style=\"color:#FFAB70\">data</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">csrfToken</span><span style=\"color:#E1E4E8\"> }) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> &#x3C;</span><span style=\"color:#B392F0\">Page</span><span style=\"color:#E1E4E8\"> />,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">})</span></span></code></pre>",
  "action_ts": "<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> { redirect } </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> './server/response'</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">export</span><span style=\"color:#F97583\"> const</span><span style=\"color:#B392F0\"> action</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> async</span><span style=\"color:#E1E4E8\"> (</span><span style=\"color:#FFAB70\">ctx</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">formData</span><span style=\"color:#E1E4E8\">) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  const</span><span style=\"color:#79B8FF\"> email</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> formData.</span><span style=\"color:#B392F0\">get</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'email'</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  </span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // 1. Validation</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  if</span><span style=\"color:#E1E4E8\"> (</span><span style=\"color:#F97583\">!</span><span style=\"color:#E1E4E8\">email </span><span style=\"color:#F97583\">||</span><span style=\"color:#F97583\"> typeof</span><span style=\"color:#E1E4E8\"> email </span><span style=\"color:#F97583\">!==</span><span style=\"color:#9ECBFF\"> 'string'</span><span style=\"color:#E1E4E8\">) {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">    // Return redirect with flash (handled by framework)</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">    // Note: framework.tsx handles the actual cookie setting based on return value</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">    // or you can set it manually if you modify framework.</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">    // In default starter:</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    return</span><span style=\"color:#E1E4E8\"> { ok: </span><span style=\"color:#79B8FF\">false</span><span style=\"color:#E1E4E8\">, error: </span><span style=\"color:#9ECBFF\">'Email is required'</span><span style=\"color:#E1E4E8\"> }</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // 2. Mutation (e.g. D1, KV)</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  await</span><span style=\"color:#E1E4E8\"> ctx.env.</span><span style=\"color:#79B8FF\">DB</span><span style=\"color:#E1E4E8\">.</span><span style=\"color:#B392F0\">prepare</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'INSERT INTO users...'</span><span style=\"color:#E1E4E8\">).</span><span style=\"color:#B392F0\">run</span><span style=\"color:#E1E4E8\">()</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // 3. Success (PRG)</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  return</span><span style=\"color:#B392F0\"> redirect</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'/thanks'</span><span style=\"color:#E1E4E8\">, { status: </span><span style=\"color:#79B8FF\">303</span><span style=\"color:#E1E4E8\"> })</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}</span></span></code></pre>",
  "framework_post_ts": "<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#6A737D\">// src/server/framework.tsx (Simplified)</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">if</span><span style=\"color:#E1E4E8\"> (method </span><span style=\"color:#F97583\">===</span><span style=\"color:#9ECBFF\"> 'POST'</span><span style=\"color:#E1E4E8\">) {</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  const</span><span style=\"color:#79B8FF\"> r</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> await</span><span style=\"color:#B392F0\"> runMatchedAction</span><span style=\"color:#E1E4E8\">(c, routes, path, url)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">  if</span><span style=\"color:#E1E4E8\"> (r.kind </span><span style=\"color:#F97583\">===</span><span style=\"color:#9ECBFF\"> 'redirect'</span><span style=\"color:#E1E4E8\">) {</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    return</span><span style=\"color:#E1E4E8\"> c.</span><span style=\"color:#B392F0\">redirect</span><span style=\"color:#E1E4E8\">(r.to, r.status)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  }</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  </span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // Set flash cookie based on result</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  setFlash</span><span style=\"color:#E1E4E8\">(c, { ok: r.kind </span><span style=\"color:#F97583\">===</span><span style=\"color:#9ECBFF\"> 'ok'</span><span style=\"color:#E1E4E8\">, at: Date.</span><span style=\"color:#B392F0\">now</span><span style=\"color:#E1E4E8\">() })</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  return</span><span style=\"color:#E1E4E8\"> c.</span><span style=\"color:#B392F0\">redirect</span><span style=\"color:#E1E4E8\">(path, </span><span style=\"color:#79B8FF\">303</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}</span></span></code></pre>",
  "form_html": "<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">&#x3C;</span><span style=\"color:#85E89D\">form</span><span style=\"color:#B392F0\"> method</span><span style=\"color:#E1E4E8\">=</span><span style=\"color:#9ECBFF\">\"post\"</span><span style=\"color:#E1E4E8\">></span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  &#x3C;</span><span style=\"color:#85E89D\">input</span><span style=\"color:#B392F0\"> type</span><span style=\"color:#E1E4E8\">=</span><span style=\"color:#9ECBFF\">\"hidden\"</span><span style=\"color:#B392F0\"> name</span><span style=\"color:#E1E4E8\">=</span><span style=\"color:#9ECBFF\">\"_csrf\"</span><span style=\"color:#B392F0\"> value</span><span style=\"color:#E1E4E8\">=</span><span style=\"color:#9ECBFF\">{csrfToken}</span><span style=\"color:#E1E4E8\"> /></span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  ...</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">&#x3C;/</span><span style=\"color:#85E89D\">form</span><span style=\"color:#E1E4E8\">></span></span></code></pre>",
  "headers_text": "<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span>X-Content-Type-Options: nosniff</span></span>\n<span class=\"line\"><span>Referrer-Policy: strict-origin-when-cross-origin</span></span>\n<span class=\"line\"><span>Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'</span></span></code></pre>",
  "wrangler_toml": "<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#E1E4E8\">[</span><span style=\"color:#B392F0\">assets</span><span style=\"color:#E1E4E8\">]</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">directory = </span><span style=\"color:#9ECBFF\">\"dist/client\"</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">binding = </span><span style=\"color:#9ECBFF\">\"ASSETS\"</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">run_worker_first = </span><span style=\"color:#79B8FF\">false</span></span></code></pre>",
  "project_tree_text": "<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span>src/</span></span>\n<span class=\"line\"><span>  routes.tsx            # your app: routing + loaders + actions + views</span></span>\n<span class=\"line\"><span>  client/</span></span>\n<span class=\"line\"><span>    entry.tsx            # only loaded on routes with client: true</span></span>\n<span class=\"line\"><span>    islands.tsx          # runtime that mounts islands into [data-island]</span></span>\n<span class=\"line\"><span>    islands.gen.ts       # auto-generated registry (build step)</span></span>\n<span class=\"line\"><span>  server/</span></span>\n<span class=\"line\"><span>    framework.tsx        # request handling (GET/POST, CSRF, flash, SSR)</span></span>\n<span class=\"line\"><span>    island.tsx           # island() helper</span></span>\n<span class=\"line\"><span>  components/</span></span>\n<span class=\"line\"><span>    Counter.client.tsx   # client island (TSX) â€” file suffix declares \"use client\"</span></span></code></pre>",
  "route_simple_ts": "<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> { defineRoute } </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> '@potetotown/vitrio-start'</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">export</span><span style=\"color:#F97583\"> const</span><span style=\"color:#79B8FF\"> routes</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> [</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  defineRoute</span><span style=\"color:#E1E4E8\">({</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    path: </span><span style=\"color:#9ECBFF\">'/'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">    loader</span><span style=\"color:#E1E4E8\">: () </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> ({ message: </span><span style=\"color:#9ECBFF\">'hello'</span><span style=\"color:#E1E4E8\"> }),</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">    component</span><span style=\"color:#E1E4E8\">: ({ </span><span style=\"color:#FFAB70\">data</span><span style=\"color:#E1E4E8\"> }) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> &#x3C;</span><span style=\"color:#B392F0\">h1</span><span style=\"color:#E1E4E8\">>{data.message}</span><span style=\"color:#F97583\">&#x3C;/</span><span style=\"color:#E1E4E8\">h1</span><span style=\"color:#F97583\">></span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  }),</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">]</span></span></code></pre>",
  "loader_parallel_ts": "<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#B392F0\">loader</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#F97583\">async</span><span style=\"color:#E1E4E8\"> ({ </span><span style=\"color:#FFAB70\">params</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">request</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">env</span><span style=\"color:#E1E4E8\"> }) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // params: from the URL (e.g. /posts/:slug)</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // request: the incoming Request</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // env: Cloudflare bindings (D1/KV/R2/etc)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // Parallelize I/O (Workers likes this)</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  const</span><span style=\"color:#E1E4E8\"> [</span><span style=\"color:#79B8FF\">post</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#79B8FF\">user</span><span style=\"color:#E1E4E8\">] </span><span style=\"color:#F97583\">=</span><span style=\"color:#F97583\"> await</span><span style=\"color:#79B8FF\"> Promise</span><span style=\"color:#E1E4E8\">.</span><span style=\"color:#B392F0\">all</span><span style=\"color:#E1E4E8\">([</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">    getPost</span><span style=\"color:#E1E4E8\">(env.</span><span style=\"color:#79B8FF\">DB</span><span style=\"color:#E1E4E8\">, params.slug),</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">    getViewer</span><span style=\"color:#E1E4E8\">(request),</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  ])</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">  if</span><span style=\"color:#E1E4E8\"> (</span><span style=\"color:#F97583\">!</span><span style=\"color:#E1E4E8\">post) </span><span style=\"color:#F97583\">return</span><span style=\"color:#E1E4E8\"> { notFound: </span><span style=\"color:#79B8FF\">true</span><span style=\"color:#E1E4E8\"> }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // Return plain JSON-ish data (serialization-safe)</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  return</span><span style=\"color:#E1E4E8\"> { post, user }</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}</span></span></code></pre>",
  "action_prg_ts": "<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> { redirect } </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> './server/response'</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#B392F0\">action</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#F97583\">async</span><span style=\"color:#E1E4E8\"> ({ </span><span style=\"color:#FFAB70\">request</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">env</span><span style=\"color:#E1E4E8\"> }) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  const</span><span style=\"color:#79B8FF\"> fd</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> await</span><span style=\"color:#E1E4E8\"> request.</span><span style=\"color:#B392F0\">formData</span><span style=\"color:#E1E4E8\">()</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  const</span><span style=\"color:#79B8FF\"> email</span><span style=\"color:#F97583\"> =</span><span style=\"color:#E1E4E8\"> fd.</span><span style=\"color:#B392F0\">get</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'email'</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">  if</span><span style=\"color:#E1E4E8\"> (</span><span style=\"color:#F97583\">typeof</span><span style=\"color:#E1E4E8\"> email </span><span style=\"color:#F97583\">!==</span><span style=\"color:#9ECBFF\"> 'string'</span><span style=\"color:#F97583\"> ||</span><span style=\"color:#F97583\"> !</span><span style=\"color:#E1E4E8\">email.</span><span style=\"color:#B392F0\">includes</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'@'</span><span style=\"color:#E1E4E8\">)) {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">    // framework will set flash cookie and redirect back (303)</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    return</span><span style=\"color:#E1E4E8\"> { ok: </span><span style=\"color:#79B8FF\">false</span><span style=\"color:#E1E4E8\">, error: </span><span style=\"color:#9ECBFF\">'invalid email'</span><span style=\"color:#E1E4E8\"> }</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">  await</span><span style=\"color:#E1E4E8\"> env.</span><span style=\"color:#79B8FF\">DB</span><span style=\"color:#E1E4E8\">.</span><span style=\"color:#B392F0\">prepare</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'INSERT INTO users(email) VALUES (?)'</span><span style=\"color:#E1E4E8\">).</span><span style=\"color:#B392F0\">bind</span><span style=\"color:#E1E4E8\">(email).</span><span style=\"color:#B392F0\">run</span><span style=\"color:#E1E4E8\">()</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // Explicit redirect (still PRG)</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  return</span><span style=\"color:#B392F0\"> redirect</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'/thanks'</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#79B8FF\">303</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}</span></span></code></pre>",
  "commands_bash": "<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#B392F0\">bun</span><span style=\"color:#9ECBFF\"> run</span><span style=\"color:#9ECBFF\"> dev</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">bun</span><span style=\"color:#9ECBFF\"> run</span><span style=\"color:#9ECBFF\"> build</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">bunx</span><span style=\"color:#9ECBFF\"> wrangler</span><span style=\"color:#9ECBFF\"> deploy</span></span></code></pre>",
  "hero_route_ts": "<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#B392F0\">defineRoute</span><span style=\"color:#E1E4E8\">({</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  path: </span><span style=\"color:#9ECBFF\">'/posts/:slug'</span><span style=\"color:#E1E4E8\">,</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // 1. Loader: Fetch data on GET (runs before SSR)</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  loader</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#F97583\">async</span><span style=\"color:#E1E4E8\"> ({ </span><span style=\"color:#FFAB70\">params</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">env</span><span style=\"color:#E1E4E8\"> }) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    const</span><span style=\"color:#79B8FF\"> post</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> await</span><span style=\"color:#E1E4E8\"> env.</span><span style=\"color:#79B8FF\">DB</span><span style=\"color:#E1E4E8\">.</span><span style=\"color:#B392F0\">prepare</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'SELECT * FROM posts WHERE slug = ?'</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">      .</span><span style=\"color:#B392F0\">bind</span><span style=\"color:#E1E4E8\">(params.slug).</span><span style=\"color:#B392F0\">first</span><span style=\"color:#E1E4E8\">()</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    if</span><span style=\"color:#E1E4E8\"> (</span><span style=\"color:#F97583\">!</span><span style=\"color:#E1E4E8\">post) </span><span style=\"color:#F97583\">return</span><span style=\"color:#E1E4E8\"> { notFound: </span><span style=\"color:#79B8FF\">true</span><span style=\"color:#E1E4E8\"> }</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    return</span><span style=\"color:#E1E4E8\"> { post }</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  },</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // 2. Action: Handle POST (PRG pattern)</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  action</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#F97583\">async</span><span style=\"color:#E1E4E8\"> ({ </span><span style=\"color:#FFAB70\">params</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">request</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">env</span><span style=\"color:#E1E4E8\"> }) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    const</span><span style=\"color:#79B8FF\"> fd</span><span style=\"color:#F97583\"> =</span><span style=\"color:#F97583\"> await</span><span style=\"color:#E1E4E8\"> request.</span><span style=\"color:#B392F0\">formData</span><span style=\"color:#E1E4E8\">()</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    await</span><span style=\"color:#E1E4E8\"> env.</span><span style=\"color:#79B8FF\">DB</span><span style=\"color:#E1E4E8\">.</span><span style=\"color:#B392F0\">prepare</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'UPDATE posts SET likes = likes + 1 WHERE slug = ?'</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">      .</span><span style=\"color:#B392F0\">bind</span><span style=\"color:#E1E4E8\">(params.slug).</span><span style=\"color:#B392F0\">run</span><span style=\"color:#E1E4E8\">()</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    return</span><span style=\"color:#B392F0\"> redirect</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">`/posts/${</span><span style=\"color:#E1E4E8\">params</span><span style=\"color:#9ECBFF\">.</span><span style=\"color:#E1E4E8\">slug</span><span style=\"color:#9ECBFF\">}`</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#79B8FF\">303</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  },</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // 3. Component: Render HTML (SSR)</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  component</span><span style=\"color:#E1E4E8\">: ({ </span><span style=\"color:#FFAB70\">data</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">csrfToken</span><span style=\"color:#E1E4E8\"> }) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> (</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    &#x3C;</span><span style=\"color:#B392F0\">article</span><span style=\"color:#E1E4E8\">></span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">      &#x3C;</span><span style=\"color:#B392F0\">h1</span><span style=\"color:#E1E4E8\">>{data.post.title}</span><span style=\"color:#F97583\">&#x3C;/</span><span style=\"color:#E1E4E8\">h1</span><span style=\"color:#F97583\">></span></span>\n<span class=\"line\"><span style=\"color:#F97583\">      &#x3C;</span><span style=\"color:#E1E4E8\">form method</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">\"post\"</span><span style=\"color:#F97583\">></span></span>\n<span class=\"line\"><span style=\"color:#F97583\">        &#x3C;</span><span style=\"color:#E1E4E8\">input type</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">\"hidden\"</span><span style=\"color:#E1E4E8\"> name</span><span style=\"color:#F97583\">=</span><span style=\"color:#9ECBFF\">\"_csrf\"</span><span style=\"color:#E1E4E8\"> value</span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\">{csrfToken} </span><span style=\"color:#F97583\">/></span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">        &#x3C;</span><span style=\"color:#B392F0\">button</span><span style=\"color:#E1E4E8\">></span><span style=\"color:#B392F0\">Like</span><span style=\"color:#E1E4E8\"> ({data.post.likes})</span><span style=\"color:#F97583\">&#x3C;/</span><span style=\"color:#E1E4E8\">button</span><span style=\"color:#F97583\">></span></span>\n<span class=\"line\"><span style=\"color:#F97583\">      &#x3C;/</span><span style=\"color:#E1E4E8\">form</span><span style=\"color:#F97583\">></span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    &#x3C;/</span><span style=\"color:#E1E4E8\">article</span><span style=\"color:#F97583\">></span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  ),</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">})</span></span></code></pre>",
  "routing_param_ts": "<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#B392F0\">defineRoute</span><span style=\"color:#E1E4E8\">({</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  path: </span><span style=\"color:#9ECBFF\">'/users/:id'</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#6A737D\">// matches /users/123</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  loader</span><span style=\"color:#E1E4E8\">: ({ </span><span style=\"color:#FFAB70\">params</span><span style=\"color:#E1E4E8\"> }) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">    // params.id is \"123\"</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    return</span><span style=\"color:#E1E4E8\"> { userId: params.id }</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  },</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  component</span><span style=\"color:#E1E4E8\">: ({ </span><span style=\"color:#FFAB70\">data</span><span style=\"color:#E1E4E8\"> }) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> &#x3C;</span><span style=\"color:#B392F0\">div</span><span style=\"color:#E1E4E8\">>User {data.userId}</span><span style=\"color:#F97583\">&#x3C;/</span><span style=\"color:#E1E4E8\">div</span><span style=\"color:#F97583\">></span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">})</span></span></code></pre>",
  "loader_example_ts": "<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#B392F0\">loader</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#F97583\">async</span><span style=\"color:#E1E4E8\"> ({ </span><span style=\"color:#FFAB70\">params</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">env</span><span style=\"color:#E1E4E8\"> }) </span><span style=\"color:#F97583\">=></span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // Parallel fetch</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  const</span><span style=\"color:#E1E4E8\"> [</span><span style=\"color:#79B8FF\">user</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#79B8FF\">posts</span><span style=\"color:#E1E4E8\">] </span><span style=\"color:#F97583\">=</span><span style=\"color:#F97583\"> await</span><span style=\"color:#79B8FF\"> Promise</span><span style=\"color:#E1E4E8\">.</span><span style=\"color:#B392F0\">all</span><span style=\"color:#E1E4E8\">([</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">    fetchUser</span><span style=\"color:#E1E4E8\">(params.id),</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">    fetchPosts</span><span style=\"color:#E1E4E8\">(params.id),</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  ])</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  </span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // Return plain object (serialization-safe)</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // This is passed to component as 'data' prop</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  return</span><span style=\"color:#E1E4E8\"> { user, posts }</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}</span></span></code></pre>",
  "worker_env_ts": "<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#6A737D\">// src/server/workers.ts</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">export</span><span style=\"color:#F97583\"> default</span><span style=\"color:#E1E4E8\"> {</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  fetch</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">request</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> Request</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">env</span><span style=\"color:#F97583\">:</span><span style=\"color:#B392F0\"> Env</span><span style=\"color:#E1E4E8\">, </span><span style=\"color:#FFAB70\">ctx</span><span style=\"color:#F97583\">:</span><span style=\"color:#79B8FF\"> any</span><span style=\"color:#E1E4E8\">) {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">    // Inject env into global scope for deep access without prop drilling</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">    // (A pragmatic tradeoff for SSR frameworks on Workers)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    ;(globalThis </span><span style=\"color:#F97583\">as</span><span style=\"color:#79B8FF\"> any</span><span style=\"color:#E1E4E8\">).__VITRIO_ENV </span><span style=\"color:#F97583\">=</span><span style=\"color:#E1E4E8\"> env</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    return</span><span style=\"color:#E1E4E8\"> app.</span><span style=\"color:#B392F0\">fetch</span><span style=\"color:#E1E4E8\">(request, env, ctx)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  },</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}</span></span></code></pre>",
  "island_server_ts": "<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#6A737D\">// routes.tsx (SSR)</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> { island } </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> './server/island'</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> { Counter } </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> './components/Counter'</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">export</span><span style=\"color:#F97583\"> function</span><span style=\"color:#B392F0\"> Page</span><span style=\"color:#E1E4E8\">() {</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  return</span><span style=\"color:#E1E4E8\"> (</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">    &#x3C;</span><span style=\"color:#B392F0\">div</span><span style=\"color:#E1E4E8\">></span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">      {</span><span style=\"color:#FFAB70\">island</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#FFAB70\">Counter</span><span style=\"color:#E1E4E8\">, { </span><span style=\"color:#FFAB70\">initial</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#79B8FF\">1</span><span style=\"color:#E1E4E8\"> }, { </span><span style=\"color:#FFAB70\">name</span><span style=\"color:#E1E4E8\">: </span><span style=\"color:#9ECBFF\">'Counter'</span><span style=\"color:#E1E4E8\"> })}</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">    &#x3C;/</span><span style=\"color:#E1E4E8\">div</span><span style=\"color:#F97583\">></span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">  )</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}</span></span></code></pre>",
  "island_client_ts": "<pre class=\"shiki github-dark\" style=\"background-color:#24292e;color:#e1e4e8\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#6A737D\">// client/entry.tsx</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">import</span><span style=\"color:#E1E4E8\"> { hydrateIslands } </span><span style=\"color:#F97583\">from</span><span style=\"color:#9ECBFF\"> './islands'</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583\">async</span><span style=\"color:#F97583\"> function</span><span style=\"color:#B392F0\"> main</span><span style=\"color:#E1E4E8\">() {</span></span>\n<span class=\"line\"><span style=\"color:#6A737D\">  // generated by scripts/gen-islands.ts</span></span>\n<span class=\"line\"><span style=\"color:#F97583\">  const</span><span style=\"color:#E1E4E8\"> { </span><span style=\"color:#79B8FF\">islands</span><span style=\"color:#E1E4E8\"> } </span><span style=\"color:#F97583\">=</span><span style=\"color:#F97583\"> await</span><span style=\"color:#F97583\"> import</span><span style=\"color:#E1E4E8\">(</span><span style=\"color:#9ECBFF\">'./islands.gen'</span><span style=\"color:#E1E4E8\">)</span></span>\n<span class=\"line\"><span style=\"color:#B392F0\">  hydrateIslands</span><span style=\"color:#E1E4E8\">(islands)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#B392F0\">main</span><span style=\"color:#E1E4E8\">()</span></span></code></pre>"
} as const
